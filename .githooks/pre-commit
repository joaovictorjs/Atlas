#!/bin/sh

BRANCH_NAME=$(git symbolic-ref --short HEAD 2>/dev/null)
PATTERN="^(feat|fix|docs|style|refactor|perf|test|build|ci|chore|hotfix|release)/.+$"
PROTECTED_BRANCHES="^(main|master|develop|development)$"

if echo "$BRANCH_NAME" | grep -qE "$PROTECTED_BRANCHES"; then
    exit 0
fi

if echo "$BRANCH_NAME" | grep -qE "$PATTERN"; then
    exit 0
else
    echo ""
    echo "‚ùå Invalid branch name!"
    echo ""
    echo "Current branch:"
    echo "  $BRANCH_NAME"
    echo ""
    echo "Expected format:"
    echo "  type/description"
    echo ""
    echo "Valid types:"
    echo "  feat/      New feature"
    echo "  fix/       Bug fix"
    echo "  docs/      Documentation changes"
    echo "  style/     Code style changes"
    echo "  refactor/  Code refactoring"
    echo "  perf/      Performance improvements"
    echo "  test/      Test changes"
    echo "  build/     Build system changes"
    echo "  ci/        CI configuration changes"
    echo "  chore/     Other changes"
    echo "  hotfix/    Emergency fixes"
    echo "  release/   Release branches"
    echo ""
    echo "Examples:"
    echo "  feat/user-authentication"
    echo "  feat/add-login-page"
    echo "  fix/null-reference-error"
    echo "  fix/resolve-memory-leak"
    echo "  docs/update-readme"
    echo "  refactor/simplify-user-service"
    echo ""
    echo "To rename your branch:"
    echo "  git branch -m $BRANCH_NAME <new-branch-name>"
    echo ""
    exit 1
fi
